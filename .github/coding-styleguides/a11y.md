# Accessibility (a11y) Standards

This document collects accessibility standards and patterns for the Back to CSS project.

## Core Principles

1. **Keyboard First** - All interactions must work with keyboard
2. **State Announced** - Screen readers must hear state changes
3. **Reduced Motion** - Respect user motion preferences
4. **Contrast Compliant** - Meet WCAG AA minimum contrast

---

## Keyboard Navigation

### All Interactive Elements Must Be Focusable

```html
<!-- ✅ Good: Native button is focusable -->
<button type="button" data-attr-target="#demo">Action</button>

<!-- ❌ Bad: Div is not focusable by default -->
<div onclick="doThing()">Action</div>
```

### Focus Visibility

Provide clear focus indicators:

```css
button:focus-visible {
  outline: 2px solid var(--btf-input-focus);
  outline-offset: 2px;
}

/* Don't remove focus styles */
/* ❌ button:focus { outline: none; } */
```

### Keyboard Shortcuts

If adding keyboard shortcuts, document them and ensure they don't conflict with screen reader commands.

---

## Toggle Buttons

Use `aria-pressed` for toggle state:

```html
<!-- Single toggle -->
<button type="button" aria-pressed="false">Dark Mode</button>

<!-- Mutually exclusive group -->
<div role="group" aria-label="Era selection">
  <button type="button" aria-pressed="true">Past</button>
  <button type="button" aria-pressed="false">Present</button>
  <button type="button" aria-pressed="false">Future</button>
</div>
```

### JavaScript Sync

```javascript
// Toggle single button
const current = button.getAttribute('aria-pressed') === 'true';
button.setAttribute('aria-pressed', String(!current));

// Toggle group (only one pressed)
groupButtons.forEach((peer) => {
  peer.setAttribute('aria-pressed', String(peer === button));
});
```

---

## Live Regions

Announce dynamic content changes:

```html
<!-- Polite announcement (waits for pause) -->
<output aria-live="polite" aria-atomic="true" data-live-value-target="#demo" data-live-value="data-speed"> 60 mph </output>

<!-- Assertive announcement (interrupts) -->
<div aria-live="assertive" aria-atomic="true">Jump activated!</div>
```

### When to Use

| Situation              | aria-live value |
| ---------------------- | --------------- |
| Status updates         | polite          |
| Form validation errors | polite          |
| Critical alerts        | assertive       |
| Timer countdowns       | polite          |

---

## Form Controls

### Labels

Every input must have an accessible label:

```html
<!-- Explicit label -->
<label for="speed-slider">Speed</label>
<input id="speed-slider" type="range" min="0" max="88" />

<!-- Implicit label -->
<label>
  Energy
  <input type="range" min="0.5" max="1.8" />
</label>

<!-- aria-label for icon buttons -->
<button type="button" aria-label="Play timeline">
  <svg><!-- play icon --></svg>
</button>
```

### Input States

```html
<!-- Disabled -->
<button type="button" disabled>Disabled</button>

<!-- Required -->
<input type="text" required aria-required="true" />

<!-- Invalid -->
<input type="number" aria-invalid="true" aria-describedby="error-msg" />
<span id="error-msg">Value must be between 0 and 88</span>
```

---

## Reduced Motion

Respect user preferences for reduced motion:

```css
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}
```

### Alternative for Animated Content

Provide static alternatives when motion is disabled:

```css
.flux-animation {
  animation: flux-glow 2s infinite;
}

@media (prefers-reduced-motion: reduce) {
  .flux-animation {
    animation: none;
    box-shadow: 0 0 20px var(--flux-color); /* Static glow */
  }
}
```

---

## Color and Contrast

### Minimum Contrast Ratios

| Content Type       | WCAG AA Ratio | WCAG AAA Ratio |
| ------------------ | ------------- | -------------- |
| Normal text        | 4.5:1         | 7:1            |
| Large text (18px+) | 3:1           | 4.5:1          |
| UI components      | 3:1           | N/A            |

### Theme Aware Colors

Use `light-dark()` for automatic theme adaptation:

```css
.element {
  background: light-dark(#eee, #333);
  color: light-dark(#222, #fff);
  border-color: light-dark(#ccc, #555);
}
```

### Don't Rely on Color Alone

Always pair color with another indicator:

```html
<!-- ✅ Good: Color + icon + text -->
<span class="status status--error">
  <svg aria-hidden="true"><!-- X icon --></svg>
  Error: Speed too low
</span>

<!-- ❌ Bad: Color only -->
<span style="color: red">Speed too low</span>
```

---

## Images and Media

### Alt Text

```html
<!-- Informative image -->
<img src="flux-capacitor.png" alt="Flux capacitor glowing at 1.21 gigawatts" />

<!-- Decorative image -->
<img src="decoration.svg" alt="" role="presentation" />

<!-- Complex image -->
<figure>
  <img src="diagram.png" alt="Time travel circuit diagram" />
  <figcaption>The three branches of the flux capacitor converge at 88 mph.</figcaption>
</figure>
```

### Icons

```html
<!-- Decorative icon -->
<svg aria-hidden="true"><!-- icon --></svg>

<!-- Icon with meaning -->
<svg role="img" aria-label="Warning"><!-- warning icon --></svg>

<!-- Icon button -->
<button type="button" aria-label="Settings">
  <svg aria-hidden="true"><!-- gear icon --></svg>
</button>
```

---

## Custom Elements Accessibility

Custom elements must expose accessible information:

```html
<flux-capacitor role="img" aria-label="Flux capacitor" aria-describedby="flux-status">
  <span id="flux-status" class="visually-hidden"> Energy level: 1.21 gigawatts. Status: Ready for time jump. </span>
  <!-- Visual content -->
</flux-capacitor>
```

### Visually Hidden Text

```css
.visually-hidden {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}
```

---

## Testing Checklist

### Keyboard Testing

- [ ] All interactive elements are focusable with Tab
- [ ] Focus order matches visual order
- [ ] Focus indicator is visible
- [ ] Escape closes modals/popovers
- [ ] Enter/Space activates buttons

### Screen Reader Testing

- [ ] All content is announced
- [ ] Images have appropriate alt text
- [ ] Form controls have labels
- [ ] State changes are announced
- [ ] Headings create logical structure

### Visual Testing

- [ ] Meets contrast requirements
- [ ] Works at 200% zoom
- [ ] Works without color
- [ ] Respects reduced motion preference

---

## Resources

- [WAI-ARIA Authoring Practices](https://www.w3.org/WAI/ARIA/apg/patterns/)
- [WCAG 2.1 Guidelines](https://www.w3.org/WAI/WCAG21/quickref/)
- [MDN ARIA Documentation](https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA)
- [Inclusive Components](https://inclusive-components.design/)
